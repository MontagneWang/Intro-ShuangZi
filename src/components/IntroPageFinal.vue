<script lang="ts" setup>
import { onMounted, ref } from "vue";
import Modal from "../utils/ToastComp.vue";
import createObserver, { delay } from "../utils/observer";

const showModal = ref(false);

let [text, fu] = [
  ref<HTMLDivElement | null>(null),
  ref<HTMLDivElement | null>(null),
];

onMounted(() => {
  createObserver(text.value as HTMLDivElement, async () => {
    await delay(500);
    (document.querySelector(".finalContainer") as HTMLElement).classList.add(
      "change"
    );
    await delay(1000);
    fu.value!.classList.add("fade-in");
    await delay(1500);
    text.value!.classList.add("fade-in");
  });
});
</script>

<template>
  <Teleport to="body">
    <modal :show="showModal" @close="showModal = false">
      <template #header>
        <h3>å…³äºæœ¬ç«™</h3>
      </template>
      <template #body>
        <p>
          âš ï¸ è¯·æ³¨æ„ï¼šæœ¬ç«™ç‚¹<span style="color: #ff0099">å¹¶é</span
          >å®˜æ–¹ç«™ç‚¹ï¼Œä»…ç”±çˆ±å¥½è€…åˆ›å»ºï¼Œæ—¨åœ¨ä¸ºåˆ°è®¿è€…æä¾›ã€Œèµ·æ°åŒå­ã€çš„ç›¸å…³ä¿¡æ¯ä¸èµ„æºã€‚
        </p>
        <p>
          æœ¬ç«™ç‚¹å°†å°½åŠ›ç¡®ä¿å†…å®¹çš„å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§ï¼Œä½†ä»å¯èƒ½ä¼šå‡ºç°æœ‰å¤±åé¢‡çš„è¡¨è¿°ï¼Œè¿™<span
            style="color: #ff0099"
            >å¹¶ä¸ä»£è¡¨</span
          >å®˜æ–¹ç«‹åœºæˆ–æ„è§ã€‚
        </p>
        <p>
          å¦‚æœæ‚¨éœ€è¦åé¦ˆé¡µé¢ä¸­å­˜åœ¨çš„<span style="color: #ff0099">é”™è¯¯/é”™ä½</span
          >ï¼Œå¯ä»¥é€šè¿‡å³é”®èœå•ä¸­çš„[<a
            href="mailto:ling.vc@foxmail.com"
            style="color: #ff0099"
            target="_blank"
            title="åé¦ˆBug"
            >åé¦ˆBug</a
          >]è”ç³»æˆ‘ï¼Œæˆ‘ä¼šå°½å¯èƒ½åŠæ—¶ä¿®æ­£ã€‚
        </p>
        <p>
          å¦‚æœæ‚¨æ˜¯<span style="color: #ff0099">å®˜æ–¹</span
          >ä¸”éœ€è¦å›æ”¶è¯¥åŸŸåï¼Œå¯ä»¥é€šè¿‡[<a
            href="mailto:ling.vc@foxmail.com"
            style="color: #ff0099"
            target="_blank"
            title="é‚®ç®±ï¼šling.vc@foxmail.com"
            >é‚®ç®±</a
          >]è”ç³»æˆ‘ï¼Œæˆ‘ä¼šå°†å½“å‰åŸŸåè½¬å…¥åˆ°æ‚¨æ‰€æä¾›çš„åŸŸåæ³¨å†Œå•†ã€‚
        </p>
      </template>
    </modal>
  </Teleport>

  <div class="finalContainer">
    <div class="mask"></div>
    <div class="content">
      <div ref="text" class="outro">
        <h2>æ¯ä¸€ä½è™šæ‹Ÿæ­Œæ‰‹éƒ½å› çˆ±è¯ç”Ÿï¼Œç”±çˆ±æˆé•¿</h2>
        <h2>æˆ‘ä»¬å°†æƒ…æ„Ÿå¯„æ‰˜äºä»–ä»¬çš„æ­Œå£°ä¹‹ä¸­</h2>
        <h2>å€Ÿç”±ä»–ä»¬ä¹‹å£ï¼Œå”±å‡ºå¿ƒä¸­æ‰€æ€</h2>
        <h2>ç¥æˆ‘ä»¬çš„åŒå­è¶Šæ¥è¶Šå¥½ï¼Œå¬ä¼—è¶Šæ¥è¶Šå¤šğŸ‰</h2>
        <br />
        <br />
        <br />
        <br />
        <div class="more">
          <p>
            æ‚¨å¯ä»¥é€šè¿‡<span style="color: #ff0099" tilte="å°è¯•ç‚¹å‡»ä½ çš„é¼ æ ‡å³é”®"
              >ã€Œå³é”®èœå•ã€</span
            >äº†è§£æ›´å¤šåŒå­çš„ä¿¡æ¯
          </p>
          <p style="margin-top: -0.8vw">
            ä¹Ÿå¯ä»¥ç‚¹å‡» [<span
              @click="showModal = !showModal"
              style="color: #ff0099"
              >æ­¤å¤„</span
            >] æŸ¥çœ‹å…³äºæœ¬ç«™ç‚¹çš„ç›¸å…³ä¿¡æ¯
          </p>
        </div>
      </div>

      <div ref="fu" class="character fu">
        <img
          alt="åŒå­"
          src="https://article.biliimg.com/bfs/new_dyn/682bb4e3d7d918509ec5eb324b4a411c1402305269.png@1e_1c.webp"
        />
      </div>

      <!-- <div ref="li" class="character li">
        <img
          alt="èµ·ç¤¼"
          src="https://article.biliimg.com/bfs/article/e41acee7c137303a9743f04fc263a749999518c3.png@1e_1c.webp"
        />
      </div> -->
    </div>
  </div>
</template>

<style lang="scss" scoped>
a {
  color: #000;
}

.finalContainer {
  // idea æ˜¯ä¸æ˜¯ç›´æ¥ç”¨ä¸€ä¸ª img æ ‡ç­¾æ’‘æ»¡å±å¹•ï¼Œé…åˆ fadeIn å°±å¯ä»¥è§£å†³ï¼Ÿ
  background: url("https://article.biliimg.com/bfs/new_dyn/a9afbbf66c3752c4d2b69377b01c0d921402305269.gif@1e_1c.webp")
    no-repeat fixed center;
  background-size: cover;
  transition: opacity 1s ease;
  opacity: 0;
  &.change {
    opacity: 1;
  }

  .mask {
    width: 84vw;
    height: 88vh;
    position: fixed;
    left: 8vw;
    top: 6vh;
    background-color: #ffffffa0;
    border-radius: 1.2vw;
  }
}
.content {
  position: relative;
  .outro {
    opacity: 0;
    margin: 31vh 0 0 20vw;
    font-size: 1.5vw;
  }

  .character {
    opacity: 0;
    height: 85vh;
    position: absolute;
    bottom: 2vh;
    &.fu {
      // opacity: 0;
      // left: 4vw;
      opacity: 0;
      left: 3vw;
      bottom: -23vh;
      height: 130vh;
    }

    &.li {
      right: 5vw;
      opacity: 0;
    }

    img {
      height: 95%;
    }
  }
}
</style>
